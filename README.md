# Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data
## ä½¿ç”¨é—ä¼ è§„åˆ’è§£å†³å¸¦å™ªå£°æ•°æ®çš„ç¬¦å·å›å½’é—®é¢˜

### 0.å®éªŒç¯å¢ƒï¼š
     Python3 , gplearn , numpy , sympy , matplotlib , seaborn

### 1 å¼•è¨€ï¼š
> **ç¬¦å·å›å½’**(Symbolic Regression)æ˜¯ä¸€ç§æµè¡Œçš„**é—ä¼ è§„åˆ’**(Genetic Programming)åº”ç”¨ã€‚ç›®çš„æ˜¯æ ¹æ®ç»™å®šçš„ä¸€ç»„ç›¸å…³æ•°æ®,æ‰¾å‡ºæ‹Ÿåˆæ•°æ®çš„å‡½æ•°è¡¨è¾¾å¼ã€‚ä¸ä¼ ç»Ÿçš„çº¿æ€§å›å½’å’Œå¤šé¡¹å¼å›å½’ç›¸æ¯”ï¼Œç¬¦å·å›å½’æ— éœ€äº‹å…ˆæŒ‡å®šç›®æ ‡å‡½æ•°çš„å½¢å¼å’Œå‚æ•°,å‡½æ•°çš„å½¢å¼å’Œå‚æ•°å‡åœ¨å›å½’çš„è¿‡ç¨‹ä¸­ç¡®å®šã€‚å› æ­¤ç¬¦å·å›å½’å…·æœ‰æ›´å¹¿æ³›çš„åº”ç”¨èŒƒå›´ã€‚
> å¯¹äºæ ·æœ¬é‡æ¯”è¾ƒå¤§ä¸”å®Œæ•´çš„æ•°æ®ï¼Œä½¿ç”¨é—ä¼ è§„åˆ’ç®—æ³•æ¥è§£å†³ç¬¦å·å›å½’é—®é¢˜ï¼Œæ€»æ˜¯èƒ½å¤Ÿå¾ˆå¿«ä¸”ç²¾ç¡®åœ°æ‹Ÿåˆå‡ºæ½œåœ¨çš„å‡½æ•°è¡¨è¾¾å¼ã€‚ä½†å¦‚æœæ•°æ®é‡æ¯”è¾ƒå°‘ï¼Œè€Œä¸”å­˜åœ¨å™ªå£°çš„æƒ…å†µä¸‹ï¼Œæ‹Ÿåˆç»“æœå¾€å¾€ä¼šåå‘å™ªå£°æ•°æ®ã€‚é’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œç»“åˆRANSCAæ–¹æ³•å¤„ç†å™ªå£°çš„æ€æƒ³ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºé‡é‡‡æ ·çš„é—ä¼ è§„åˆ’ç®—æ³•**RSGP**(ReSample Genetic Programming)ï¼Œå¯¹ä¸åŒå™ªå£°ç‡å’Œå™ªå£°æ°´å¹³çš„æ•°æ®è¿›è¡Œç¬¦å·å›å½’æ‹Ÿåˆï¼ŒæŸ¥çœ‹æ”¹è¿›ç®—æ³•çš„æŠ—å™ªèƒ½åŠ›ã€‚

### 2 é—ä¼ è§„åˆ’åŸç†
>  é—ä¼ è§„åˆ’åŸºæœ¬åŸç†æ˜¯éšæœºäº§ç”Ÿä¸€ä¸ªé€‚åˆäºç»™å®šç¯å¢ƒçš„åˆå§‹ç¾¤ä½“ã€‚æ¯ä¸ªç¾¤ä½“çš„ä¸ªä½“éƒ½æœ‰ä¸€ä¸ªé€‚åº”åº¦å€¼ï¼Œç”¨é—ä¼ ç®—æ³•å¤„ç†å¾—åˆ°é«˜é€‚åº”åº¦çš„ä¸ªä½“ï¼Œäº§ç”Ÿä¸‹ä¸€ä»£çš„ç¾¤ä½“ã€‚é€šè¿‡ä¸ªä½“å¤åˆ¶ã€äº¤å‰ã€å˜å¼‚ç­‰è¿‡ç¨‹ä¸æ–­è¿›åŒ–ï¼Œç›´åˆ°å‡ºç°ç»™å®šé—®é¢˜çš„è§£æˆ–è¿‘ä¼¼è§£ä¸ºæ­¢ã€‚ é—ä¼ è§„åˆ’æ˜¯ä¸€ç§ç›¸å½“æœ‰æ•ˆçš„ç¬¦å·å›å½’æ–¹æ³•ï¼Œå®ƒçš„ä¼˜åŠ¿æºäºå…¶ç»“æ„çš„çµæ´»æ€§ï¼Œç”±äºé‡‡ç”¨æ ‘å½¢ç»“æ„ï¼Œå¯ä»¥æè¿°å±‚æ¬¡åŒ–çš„é—®é¢˜ï¼Œå…‹æœäº†ä¼ ç»Ÿæ–¹æ³•ä¸­ç¡®å®šå‡½æ•°ç»“æ„éš¾çš„ç¼ºé™·ã€‚<br>
ä¸‹å›¾æ—¶æ ‘ç»“æ„çš„å¤§è‡´è¡¨è¾¾å½¢å¼ï¼Œå‰åºéå†æ ‘å¯å¾—åˆ°å‰ç¼€è¡¨è¾¾å¼ï¼Œå¯è¿˜åŸå‡ºè¡¨è¾¾å¼ã€‚æ›²çº¿æ˜¯è¡¨è¾¾å¼çš„è¡¨ç°å‹ã€‚
![æ ‘ç»“æ„](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E6%A0%91%E7%BB%93%E6%9E%84.png)

##### 2.1 é—ä¼ è§„åˆ’çš„åŸºæœ¬è¦ç´ 

> (1) **ç»ˆæ­¢ç¬¦é›†**(terminals): ç»ˆæ­¢ç¬¦é›†æ˜¯é—®é¢˜ä¸­æœ€åŸºæœ¬çš„å…ƒç´ ,åŒ…æ‹¬å˜é‡å’Œå¸¸é‡. 
>
> (2) **å‡½æ•°ç¬¦é›†**(functions): å‡½æ•°ç¬¦é›†å¯ä»¥æ˜¯ç®—æœ¯è¿ç®—ã€å‡½æ•°è¿ç®—ã€é€»è¾‘è¿ç®—æˆ–ç¨‹åºè¿ç®—ç­‰,  å¦‚+, - , Ã— , Ã·,sin,cos,log,exp ç­‰.
>
> (3) **é€‚åº”åº¦å€¼**(fitness): é€‚åº”åº¦å€¼å‡½æ•°ç»™å‡ºäº†æ‰€ç ”ç©¶ç¯å¢ƒä¸‹ç¾¤ä½“ä¸­æ¯ä¸ªä¸ªä½“å¥½åç¨‹åº¦çš„è¯„ä»·æ–¹æ³•ã€‚å¦‚$R^2$æˆ–$MAE$

##### 2.2 é—ä¼ è§„åˆ’çš„ä¸»è¦ç®—å­

 é—ä¼ è§„åˆ’çš„åŸºæœ¬é—ä¼ ç®—å­ä¸»è¦åŒ…æ‹¬**å¤åˆ¶**ã€**äº¤å‰**å’Œ**å˜å¼‚**ç­‰

1)**å¤åˆ¶**ï¼šåŸºäºé€‚åº”åº¦çš„ä¸ªä½“é€‰æ‹©æ–¹æ³•, ä»ç¾¤ä½“ä¸­é€‰å‡ºä¸€ä¸ªçˆ¶ä»£ä¸ªä½“,ä¸å¯¹å…¶åšä»»ä½•çš„å˜åŒ–ä¾¿å¤åˆ¶åˆ°æ–°çš„ä¸€ä»£ä¸­

2)**äº¤å‰**ï¼šéšæœºä»çˆ¶ä»£ä¸­é€‰æ‹©å‡ºä¸€äº›ä¸ªä½“, é€‰æ‹©å…¶ä¸­æœ€å¥½çš„ä¸ªä½“è¿›è¡Œäº¤å‰æ“ä½œ
 ![äº¤å‰](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E4%BA%A4%E5%8F%89.png)
3)**å˜å¼‚**ï¼š ä»å½“å‰ç¾¤ä½“ä¸­é€‰æ‹©ä¸€ä¸ªå•ä½“,å¹¶éšæœºé€‰å®šä¸€ä¸ª(æˆ–å¤šä¸ª)ç»“ç‚¹ä½œä¸ºå˜å¼‚ç‚¹,å¯¹å˜å¼‚ç‚¹åŠå…¶ä»¥ä¸‹éƒ¨åˆ†éšæœºæ›¿æ¢è€Œç”Ÿæˆæ–°çš„å•ä½“

1. **å­æ ‘å˜å¼‚**ï¼š
![å­æ ‘å˜å¼‚](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E5%AD%90%E6%A0%91%E5%8F%98%E5%BC%82.png)
2.**hoistå˜å¼‚**ï¼š
![hoistå˜å¼‚](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/hoist%E5%8F%98%E5%BC%82.png)
3.**ç‚¹å˜å¼‚**ï¼š
![ç‚¹å˜å¼‚](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E7%82%B9%E5%8F%98%E5%BC%82.png)

### 3 æ·»åŠ å™ªå£°

##### 3.1 å‡»ç©¿ç‚¹(Breakdown Point)

å‡»ç©¿ç‚¹æ˜¯ä¸€ç§é²æ£’æ€§åº¦é‡ï¼Œè¡¡é‡å›å½’å™¨å¯¹å™ªå£°æ•°æ®çš„æœ€å¤§å®¹å¿åº¦ã€‚å‡»ç©¿ç‚¹è¶Šå¤§ï¼Œä¼°è®¡å™¨å°±è¶Šç¨³å¥ã€‚åœ¨ç»Ÿè®¡ä¸Šæ¥è¯´ï¼Œå¦‚æœæ€»ä½“æ ·æœ¬ä¸­è¶…è¿‡ä¸€åŠçš„æ•°æ®éƒ½æ˜¯è¾ƒå¤§çš„å™ªå£°ï¼Œåˆ™æ— æ³•å°†æ ·æœ¬ä¸­çš„æ½œåœ¨åˆ†å¸ƒå’Œå™ªå£°æ•°æ®çš„åˆ†å¸ƒåŒºåˆ†å¼€ã€‚

##### 3.2 å™ªå£°ç‡(NoiseRatio)å’Œå™ªå£°æ°´å¹³(NoiseLevel)

åœ¨å®éªŒä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹éƒ¨åˆ†($\epsilon$)æ•°æ®æ·»åŠ é«˜æ–¯å™ªå£°g(0, $\sigma$ ),å…¶ä¸­gæ˜¯å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º $\sigma$ çš„é«˜æ–¯éšæœºæ•°ã€‚
å™ªå£°ç‡$\epsilon$ è€ƒè™‘èŒƒå›´ä¸º[0.1,0.2,0.3,0.4,0.5]ï¼›å™ªå£°æ°´å¹³$\sigma$åˆ™å–åŒºé—´ç›®æ ‡å€¼èŒƒå›´çº¦25%å’Œ50%çš„æ ‡å‡†å·®æ°´å¹³ã€‚
å³åœ¨ä¸åŒå™ªå£°ç‡$\epsilon$å’Œå™ªå£°æ°´å¹³g(0,ğœ)å–å€¼ä¸‹å¯¹æ¯ç»„æ•°æ®åš10æ¬¡æµ‹è¯•ã€‚

å¦‚ä¸‹å›¾ï¼š
- å·¦å­å›¾æ˜¯åŸå§‹æ— å™ªå£°çš„æ•°æ®
- ä¸­å­å›¾æ˜¯åœ¨$\epsilon$=0.2ï¼Œ$\sigma$=25%å–å€¼ä¸‹æ·»åŠ å™ªå£°åçš„æ•°æ®
- å³å­å›¾æ˜¯åœ¨$\epsilon$=0.5ï¼Œ$\sigma$=50%å–å€¼ä¸‹æ·»åŠ å™ªå£°åçš„æ•°æ®
![](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E5%99%AA%E5%A3%B0%E6%95%B0%E6%8D%AE%E6%BC%94%E7%A4%BA.png)


#### 3.å®éªŒç»“æœå¯¹æ¯”ï¼š
![ç¬¬ä¸€ä¸ªå‡½æ•°çš„ä¸¤ç§æ–¹æ³•æ‹Ÿåˆæ•ˆæœå¯¹æ¯”](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E5%AF%B9%E6%AF%94%E5%9B%BE1.png)
![ç¬¬äºŒä¸ªå‡½æ•°çš„ä¸¤ç§æ–¹æ³•æ‹Ÿåˆæ•ˆæœå¯¹æ¯”](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E5%AF%B9%E6%AF%94%E5%9B%BE2.png)

#### 4.å¯è§†åŒ–ä¸åŒå™ªå£°ç‡å’Œä¸åŒå™ªå£°æ°´å¹³ä¸‹çš„æ‹Ÿåˆä¼˜åº¦å’Œå‡æ–¹è¯¯å·®
![ç¬¬ä¸€ä¸ªå‡½æ•°çš„ä¸¤ç§æ–¹æ³•æ‹Ÿåˆå¯¹æ¯”](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/x%5E4%2Bx%5E3%2Bx%5E2%2Bx__%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9B%B8%E5%85%B3%E6%80%A7%E5%92%8C%E8%AF%AF%E5%B7%AE.png)
![ç¬¬äºŒä¸ªå‡½æ•°çš„ä¸¤ç§æ–¹æ³•æ‹Ÿåˆå¯¹æ¯”](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/1%2Bsin(3x)__%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9B%B8%E5%85%B3%E6%80%A7%E5%92%8C%E8%AF%AF%E5%B7%AE.png)


#### 5.å¯¹æ¯”è¡¨æ ¼

                                          å‡½æ•°1çš„å®éªŒæ•°æ®å¯¹æ¯”è¡¨
                                                      
![ç¬¬ä¸€ä¸ªå‡½æ•°çš„ä¸¤ç§æ–¹æ³•æ‹Ÿåˆå¯¹æ¯”](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%A0%BC1.png)

                                          å‡½æ•°2çš„å®éªŒæ•°æ®å¯¹æ¯”è¡¨
                                                      
![ç¬¬äºŒä¸ªå‡½æ•°çš„ä¸¤ç§æ–¹æ³•æ‹Ÿåˆå¯¹æ¯”](https://github.com/summershaaa/Genetic-Programming-to-Solve-Symbol-Regression-with-Noisy-Data/blob/master/Image/%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%A0%BC2.png)

